<div class="container">
  <h1>Pokemon Rankings</h1>
  <img [src]="imageService.imageUrl('/misc/pokemon/pokemon-trainer.gif')" alt="cool gif with pokemon trainer">
  <p>I'm tired of all of these terrible opinions about pokemon. On this webpage I have put all 1025 pokemon into a tier list. Criteria is vibes only. SS, S and F tiers are ordered.</p>
  <div class="sorting-buttons generations">
    <button (click)="toggleGeneration(1)" [class.selected]="activeGenerations.has(1)">Gen 1</button>
    <button (click)="toggleGeneration(2)" [class.selected]="activeGenerations.has(2)">Gen 2</button>
    <button (click)="toggleGeneration(3)" [class.selected]="activeGenerations.has(3)">Gen 3</button>
    <button (click)="toggleGeneration(4)" [class.selected]="activeGenerations.has(4)">Gen 4</button>
    <button (click)="toggleGeneration(5)" [class.selected]="activeGenerations.has(5)">Gen 5</button>
    <button (click)="toggleGeneration(6)" [class.selected]="activeGenerations.has(6)">Gen 6</button>
    <button (click)="toggleGeneration(7)" [class.selected]="activeGenerations.has(7)">Gen 7</button>
    <button (click)="toggleGeneration(8)" [class.selected]="activeGenerations.has(8)">Gen 8</button>
    <button (click)="toggleGeneration(9)" [class.selected]="activeGenerations.has(9)">Gen 9</button>
  </div>

  <div class="sorting-buttons regions">
    <button (click)="toggleRegion('alolan')" [class.selected]="activeRegions.has('alolan')">Alolan</button>
    <button (click)="toggleRegion('galarian')" [class.selected]="activeRegions.has('galarian')">Galarian</button>
    <button (click)="toggleRegion('hisuian')" [class.selected]="activeRegions.has('hisuian')">Hisuian</button>
    <button (click)="toggleRegion('paldean')" [class.selected]="activeRegions.has('paldean')">Paldean</button>
  </div>

  <div class="sorting-buttons types">
    <button
      *ngFor="let type of pokemonTypes"
      (click)="toggleType(type)"
      class="type-button"
      [ngClass]="type.toLowerCase()"
      [class.selected]="activeTypes.has(type)">
      {{ type | titlecase }}
    </button>
  </div>

  <div class="sorting-buttons misc">
    <button (click)="toggleFilterMode()">Mode: {{ filterMode }}</button>
    <button (click)="clearFilters()">Clear Filters</button>
    <button (click)="collapseAllTiers()">Collapse All</button>
    <button (click)="expandAllTiers()">Open All</button>
  </div>

  <div class="tiers-container">
    <div *ngFor="let tierKey of orderedTiers">
      <div class="tier-header" (click)="toggleTier(tierKey)">
        <span class="tier-name">{{ tierKey }}</span>
        <span class="tier-description">{{ tierHeadings[tierKey] }}</span>
        <span class="arrow">{{ collapsed[tierKey] ? "▶" : "▼" }}</span>
      </div>
      <div class="tier-content" *ngIf="!collapsed[tierKey]">
        <div class="pokemon-grid">
          <div
            class="pokemon-card"
            *ngFor="let p of tiers[tierKey]"
            [title]="p.number + ' – ' + p.name"
            (click)="openModal(p)"
          >
            <img
              [src]="imageService.imageUrl('/misc/pokemon/' + p.image)"
              loading="lazy"
              [alt]="p.name">
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="modal" *ngIf="selectedPokemon" (click)="closeModal()">
  <app-close-button (click)="close.emit()"/>
  <div class="modal-content" (click)="$event.stopPropagation()">
    <h2>#{{ selectedPokemon.number }} – {{ selectedPokemon.name }}</h2>
    <img
      class="modal-image"
      [src]="imageService.imageUrl('/misc/pokemon/' + selectedPokemon.image)"
      [alt]="selectedPokemon.name">
    <p>{{ selectedPokemon.description }}</p>
  </div>
</div>
